#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
# 1-dns-transfer.py3 CODIGOS

"""
  Esse arquivo faz o DNS 
  Transfer 

  Modificado em 01 de novembro de 2018
  por Vitor Mazuco (contato@vmzsolutions.com.br)

"""

import dns.query
import dns.zone
import dns.resolver

dominio = "teste.com.br"
registrosNS = dns.resolver.query(dominio, "NS") #1
lista = []

for registro in registrosNS: #2
    lista.append( str(registro) )

for registro in lista:
    try:
        ZoneTransfer = dns.zone.from_xfr(dns.query.xfr(registro, dominio)) #3
    except:
        print("Erro")
    else: 
        registroDNS = list(ZoneTransfer.nodes.keys())
        registroDNS.sort()
        for n in registroDNS:
            print(ZoneTransfer[n].to_text(n))
