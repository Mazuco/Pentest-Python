#!/usr/bin/env python
# -*- coding: UTF-8 -*-
# 1-port-scannerScapy.py CODIGOS

"""
  Esse arquivo executa a varredura
  de portas com scapy

  Modificado em 06 de novembro de 2018
  por Vitor Mazuco (contato@vmzsolutions.com.br)

"""

from scapy.all import *
conf.verb = 0 #1 

portas = [1,21,22,23,80,443,8001,8080] # 2 

pacoteIP = IP(dst ="IP do host")
pacoteTCP = TCP(dport=portas, flags="S")
pacote = pacoteIP/pacoteTCP

ans, unans = sr(pacote, inter=0.1, timeout=1) #3 

print "Porta\tEstado"
for pacoteRecebido in ans:
    print pacoteRecebido[1][IP].sport, \
    "\t", pacoteRecebido[1][TCP].sprintf("%flags%") #4 
















