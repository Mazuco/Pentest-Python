#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
# 3 - arping.py3 SLIDES

"""
  Esse arquivo executa ARP Request

  Modificado em 06 de novembro de 2018
  por Vitor Mazuco (contato@vmzsolutions.com.br)

"""
import sys
try:
    from scapy.all import *
except:
    sys.exit("[!] Instale a biblioteca nmap com o comando: sudo pip3 install scapy")

conf.verb = 0 #1 

IPs = []

for ip in range(1, 255):
    IPs.append("192.168.0."+str(ip))

pacoteARP = Ether()/ARP(pdst=IPs, hwdst="ff:ff:ff:ff:ff:ff") # 2 
ans, unans = srp(pacoteARP, inter=0.1, timeout=1)

print("IP\t\tMAC")
for pacoteRecebido in ans:
    print(pacoteRecebido[1].psrc, "\t", pacoteRecebido[1].hwsrc) #2


