#!/usr/bin/env python
# -*- coding: UTF-8 -*-
# 3 - arping.py SLIDES

"""
  Esse arquivo executa ARP Request

  Modificado em 06 de novembro de 2018
  por Vitor Mazuco (contato@vmzsolutions.com.br)

"""

from scapy.all import *
conf.verb = 0 #1 Verbosidade zero

IPs = []

for ip in range(1, 255):
    IPs.append("192.168.0."+str(ip))

pacoteARP = Ether()/ARP(pdst=IPs, hwdst="ff:ff:ff:ff:ff:ff") # 2 Usamos o pacote ARP a ser enviado
ans, unans = srp(pacoteARP, inter=0.1, timeout=1)

print("IP\t\tMAC")
for pacoteRecebido in ans:
    print(pacoteRecebido[1].psrc, "\t", pacoteRecebido[1].hwsrc) #2 Os que responderem ao pedido ARP ser√£o revelados os seus MAC Address


