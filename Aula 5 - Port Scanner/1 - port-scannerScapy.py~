#!/usr/bin/env python
# -*- coding: UTF-8 -*-
# 1 - port-scannerScapy.py CODIGOS

"""
  Esse arquivo executa a varredura
  de portas com scapy

  Modificado em 06 de novembro de 2018
  por Vitor Mazuco (contato@vmzsolutions.com.br)

"""

from scapy.all import *
conf.verb = 0 #1 Configuração da verbosidade, deixando apenas o necessário

portas = [1,21,22,23,80,443,8001,8080] # 2 Portas a serem escaneadas

pacoteIP = IP(dst ="IP do host")
pacoteTCP = TCP(dport=portas, flags="S")
pacote = pacoteIP/pacoteTCP

ans, unans = sr(pacote, inter=0.1, timeout=1) #3 Pacote com TCP e o tempo de intervalo "inter=0.1" de 0.1 segundo com timeout de 1 segundo para a espera da reposta.

print "Porta\tEstado"
for pacoteRecebido in ans:
    print pacoteRecebido[1][IP].sport, \
    "\t", pacoteRecebido[1][TCP].sprintf("%flags%") #4 Imprime o seu estado atual da porta SA é aberta, RA é fechada
















